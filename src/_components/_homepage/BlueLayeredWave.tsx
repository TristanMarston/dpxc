'use client';

import { useEffect, useRef } from 'react';

const BlueLayeredWave = () => {
    const svgRef = useRef<SVGSVGElement>(null);

    useEffect(() => {
        if (svgRef.current) {
            const bbox = getSVGBoundingBox(svgRef.current);
            svgRef.current.setAttribute('viewBox', `${bbox.x} ${bbox.y - 5} ${bbox.width} ${bbox.height}`);
        }
    }, []);

    const getSVGBoundingBox = (svg: SVGSVGElement): DOMRect => {
        const paths = svg.querySelectorAll('path');
        let minX = Infinity,
            minY = Infinity,
            maxX = -Infinity,
            maxY = -Infinity;

        paths.forEach((path) => {
            const bbox = path.getBBox();
            if (bbox.x < minX) minX = bbox.x;
            if (bbox.y < minY) minY = bbox.y;
            if (bbox.x + bbox.width > maxX) maxX = bbox.x + bbox.width;
            if (bbox.y + bbox.height > maxY) maxY = bbox.y + bbox.height;
        });

        return new DOMRect(minX, minY, maxX - minX, maxY - minY);
    };

    return (
        <svg className='w-screen' id='visual' xmlns='http://www.w3.org/2000/svg' xmlnsXlink='http://www.w3.org/1999/xlink' ref={svgRef} version='1.1'>
            <rect x='0' y='0' fill='#001E44'></rect>

            <path
                d='M0 363L21.5 376.2C43 389.3 86 415.7 128.8 424.5C171.7 433.3 214.3 424.7 257.2 424.5C300 424.3 343 432.7 385.8 425C428.7 417.3 471.3 393.7 514.2 386.2C557 378.7 600 387.3 642.8 396.3C685.7 405.3 728.3 414.7 771.2 415.7C814 416.7 857 409.3 878.5 405.7L900 402L900 601L878.5 601C857 601 814 601 771.2 601C728.3 601 685.7 601 642.8 601C600 601 557 601 514.2 601C471.3 601 428.7 601 385.8 601C343 601 300 601 257.2 601C214.3 601 171.7 601 128.8 601C86 601 43 601 21.5 601L0 601Z'
                fill='#001e44'
            ></path>
            <path
                d='M0 398L21.5 404C43 410 86 422 128.8 426C171.7 430 214.3 426 257.2 425C300 424 343 426 385.8 420.7C428.7 415.3 471.3 402.7 514.2 396C557 389.3 600 388.7 642.8 389.8C685.7 391 728.3 394 771.2 406C814 418 857 439 878.5 449.5L900 460L900 601L878.5 601C857 601 814 601 771.2 601C728.3 601 685.7 601 642.8 601C600 601 557 601 514.2 601C471.3 601 428.7 601 385.8 601C343 601 300 601 257.2 601C214.3 601 171.7 601 128.8 601C86 601 43 601 21.5 601L0 601Z'
                fill='#00234f'
            ></path>
            <path
                d='M0 489L21.5 485.8C43 482.7 86 476.3 128.8 475.2C171.7 474 214.3 478 257.2 475.7C300 473.3 343 464.7 385.8 455.5C428.7 446.3 471.3 436.7 514.2 432C557 427.3 600 427.7 642.8 435.8C685.7 444 728.3 460 771.2 466.8C814 473.7 857 471.3 878.5 470.2L900 469L900 601L878.5 601C857 601 814 601 771.2 601C728.3 601 685.7 601 642.8 601C600 601 557 601 514.2 601C471.3 601 428.7 601 385.8 601C343 601 300 601 257.2 601C214.3 601 171.7 601 128.8 601C86 601 43 601 21.5 601L0 601Z'
                fill='#00285a'
            ></path>
            <path
                d='M0 513L21.5 507.7C43 502.3 86 491.7 128.8 489.8C171.7 488 214.3 495 257.2 501.8C300 508.7 343 515.3 385.8 519C428.7 522.7 471.3 523.3 514.2 522.8C557 522.3 600 520.7 642.8 518.5C685.7 516.3 728.3 513.7 771.2 503.8C814 494 857 477 878.5 468.5L900 460L900 601L878.5 601C857 601 814 601 771.2 601C728.3 601 685.7 601 642.8 601C600 601 557 601 514.2 601C471.3 601 428.7 601 385.8 601C343 601 300 601 257.2 601C214.3 601 171.7 601 128.8 601C86 601 43 601 21.5 601L0 601Z'
                fill='#002d66'
            ></path>
            <path
                d='M0 513L21.5 515.8C43 518.7 86 524.3 128.8 527.2C171.7 530 214.3 530 257.2 530.5C300 531 343 532 385.8 526.7C428.7 521.3 471.3 509.7 514.2 505.8C557 502 600 506 642.8 509.2C685.7 512.3 728.3 514.7 771.2 513.7C814 512.7 857 508.3 878.5 506.2L900 504L900 601L878.5 601C857 601 814 601 771.2 601C728.3 601 685.7 601 642.8 601C600 601 557 601 514.2 601C471.3 601 428.7 601 385.8 601C343 601 300 601 257.2 601C214.3 601 171.7 601 128.8 601C86 601 43 601 21.5 601L0 601Z'
                fill='#003271'
            ></path>
            <path
                d='M0 543L21.5 545.3C43 547.7 86 552.3 128.8 556.7C171.7 561 214.3 565 257.2 563.5C300 562 343 555 385.8 552.3C428.7 549.7 471.3 551.3 514.2 555.8C557 560.3 600 567.7 642.8 570C685.7 572.3 728.3 569.7 771.2 566.3C814 563 857 559 878.5 557L900 555L900 601L878.5 601C857 601 814 601 771.2 601C728.3 601 685.7 601 642.8 601C600 601 557 601 514.2 601C471.3 601 428.7 601 385.8 601C343 601 300 601 257.2 601C214.3 601 171.7 601 128.8 601C86 601 43 601 21.5 601L0 601Z'
                fill='#00377d'
            ></path>
        </svg>
    );
};

export default BlueLayeredWave;
